# 电影院选座系统

## 完成记录

7.19：基础页面和200人canvas绘制部分已经完成，还剩下100和300座位的绘制，整体代码框架基本完成。

## 协作说明（必读）

**main**：可发布分支，即最终分支，我们暂时用不到，最后版本放在main分支中
**develop**：测试整合分支，即我们要将自己负责部分的分支合并到此分支
**feat/###**：各位同学自己负责的功能分支，如曹景琦负责基础页面和canvas的绘制，分支名为feat/canvas，自己起名表明功能即可

开始开发时，请clone本仓库，然后在develop分支下新建自己的功能分支，进行开发，自己的部分开发完成后PR到develop分支（pull request），组长负责查看代码质量并整合。

每次开发时都要先切换到develop分支pull一下，保持自己的版本是最新的，然后切换到自己的分支，将新拉取的更改合并到自己的分支。

各个功能在各自的js文件中，其他文件只需要配合进行少量修改即可

## 分工

### 成员1：项目架构与Canvas绘图实现
主要职责：
搭建基础 HTML 页面结构
使用 Canvas 绘制影院座位图（200座位，10排×20列，弧形排布）；
用颜色区分：空座（绿色）、选中未售（黄色）、已售（红色）；
座位号与排号显示。
要求技能：
HTML/CSS 基础；
熟练掌握 Canvas API
能处理座位的坐标映射（弧形布局）；

### 成员2：交互逻辑与手动/自动选座
主要职责：
实现点击选中座位（单选、多选 Ctrl+点击）；
处理观众信息输入（姓名、年龄）；
编写自动选座逻辑（基于年龄判断座位区域）；
实现团体票选座（最多20人，同排、适龄限制）；
要求技能：
熟悉 JavaScript 事件处理；
能编写逻辑判断与条件过滤；
能处理团体自动排座逻辑（查找合适连续座位）。

### 成员3：票务操作模块（预定、购票、退票）
主要职责：
实现以下操作流程：
预定座位；
付款/确认购票；
取消预定；
退票（变回空座）；
更新座位状态并刷新显示颜色；
维护一个座位状态数据结构（如二维数组或对象）。
要求技能：
熟悉 JS 状态管理；
熟练 DOM 操作；
熟悉逻辑分支与事务处理。

### 成员4：配置功能、页面优化、说明文档撰写
主要职责：
页面上的参数配置实现（观影厅大小选择：100人/200人/300人）；
使用文本框、下拉菜单等组件实现动态配置；
撰写说明文档 report.pdf（包括功能说明、实现思路、参考文献等）；
负责页面美化与整体结构优化，确保可读性与评分友好性；
负责最终项目打包整理、测试是否可直接运行。
要求技能：
HTML 表单元素使用；
文档写作能力；
有全局视角和整合能力。

## 项目结构

```
Cinema-Seat-Selection/
├── index.html          # 主页面
└── css/ 
    ├── styles.css         # 样式文件
├── script.js           # 主控制器
└── js/                 # JavaScript模块目录
    ├── canvas-draw.js      # 画布绘制模块
    ├── seat-select.js      # 座位选择模块
    ├── ticket-manager.js   # 票务管理模块
    └── config-ui.js        # 配置和UI管理模块
```

## 模块功能说明

### 1. script.js - 主控制器

- **作用**: 系统的主入口点，负责初始化和协调各个模块
- **主要功能**:
  - 初始化座位配置和状态
  - 创建各功能模块实例
  - 绑定事件监听器
  - 作为各模块之间的通信桥梁

### 2. canvas-draw.js - 画布绘制模块
- **作用**: 负责所有与Canvas画布相关的绘制功能
- **主要功能**:
  - 计算座位在弧形布局中的坐标
  - 绘制所有座位（空座、已选、已售）
  - 绘制单个座位
  - 绘制排号标识

### 3. seat-select.js - 座位选择模块
- **作用**: 处理座位选择的所有逻辑
- **主要功能**:
  - 检测鼠标点击位置对应的座位
  - 处理座位点击事件（单选、多选）
  - 更新已选座位的显示
  - 个人自动选座算法
  - 团体自动选座算法
  - 根据年龄推荐最佳座位
  - 清除选择功能

### 4. ticket-manager.js - 票务管理模块
- **作用**: 管理票务相关的业务逻辑
- **主要功能**:
  - 预订座位
  - 购买票务
  - 退票功能
  - 价格计算

### 5. config-ui.js - 配置和UI管理模块
- **作用**: 管理用户界面配置和交互
- **主要功能**:
  - 切换票务类型显示（个人票/团体票）
  - 添加团体成员
  - 动态更新团体成员输入框

## 模块间依赖关系

```
script.js (主控制器)
    ├── 依赖 CanvasDraw
    ├── 依赖 SeatSelect
    ├── 依赖 TicketManager
    └── 依赖 ConfigUI

SeatSelect
    ├── 依赖 CanvasDraw (用于重绘座位)
    └── 依赖 CinemaSeating (访问座位数据)

TicketManager
    ├── 依赖 CanvasDraw (用于重绘座位)
    ├── 依赖 SeatSelect (更新选择显示)
    └── 依赖 CinemaSeating (访问座位数据)

ConfigUI
    ├── 依赖 SeatSelect (团体自动选座)
    └── 依赖 CinemaSeating (访问配置数据)
```

## 优势

1. **模块化分离**: 每个模块负责特定的功能，代码更加清晰易维护
2. **职责单一**: 每个类都有明确的职责，符合单一职责原则
3. **易于扩展**: 需要添加新功能时，只需在对应模块中添加或创建新模块
4. **易于测试**: 每个模块可以独立测试
5. **代码复用**: 模块化的代码更容易在其他项目中复用
6. **团队协作**: 不同开发者可以同时维护不同的模块

## 使用说明

1. 确保在HTML中按照正确的顺序引入JavaScript文件
2. 各功能模块需要在主控制器之前加载
3. 修改功能时，只需要关注对应的模块文件
4. 添加新功能时，可以创建新的模块文件并在主控制器中引用

